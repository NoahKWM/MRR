knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
f <- ggplot(data.frame(x = c(-4, 4)), aes(x))
f + stat_function(fun = dnorm, colour = "cornflowerblue") +
stat_function(fun = dnorm, colour = "coral",args=list(sd=2))
library(tidyverse)
install.packages("tidyverse")
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
install.packages(tidyverse)
library(glmnet)
?cv.glmnet
setwd('C:\\Users\\noahk\\Documents\\Perso\\Cours\\S3\\MERR\\MRR\\TP3')
knitr::opts_chunk$set(echo = TRUE)
# Load the dataset
tab <- read.csv(file = "cookies.csv", sep = ',', dec = '.', header = TRUE)
# Create the binary target variable YBin
YBin <- as.numeric(tab$fat > median(tab$fat))
# Compute the features (mean, sd, slope, min, max) for each spectrum
features <- cbind(
mean = apply(tab[, -1], 1, mean),
sd = apply(tab[, -1], 1, sd),
slope = apply(tab[, -1], 1, function(x) lm(x ~ 1:length(x))$coefficients[2]),
min = apply(tab[, -1], 1, min),
max = apply(tab[, -1], 1, max)
)
# Load the dataset
tab <- read.csv(file = "cookies.csv", header = TRUE)
# Create the binary target variable YBin
YBin <- as.numeric(tab$fat > median(tab$fat))
# Compute the features (mean, sd, slope, min, max) for each spectrum
features <- cbind(
mean = apply(tab[, -1], 1, mean),
sd = apply(tab[, -1], 1, sd),
slope = apply(tab[, -1], 1, function(x) lm(x ~ 1:length(x))$coefficients[2]),
min = apply(tab[, -1], 1, min),
max = apply(tab[, -1], 1, max)
)
# Load the dataset
cookies_data <- read.csv(file = "cookies.csv", header = TRUE)
# Create the binary target variable YBin
YBin <- as.numeric(tab$fat > median(cookies_data$fat))
# Computation (mean, standard deviation, minimum and maximum)
cookies_data$mean <- rowMeans(cookies_data[, 2:701])
cookies_data$stDev <- apply(cookies_data[, 2:701], 1, sd)
cookies_data$min <- apply(cookies_data[, 2:701], 1, min)
cookies_data$max <- apply(cookies_data[, 2:701], 1, max)
# Computation (slope)
# Function: compute_slope
# @param: spectrum_values of a cookie (here, column 2 to 701)
# @return: slope of the spectrum curve for a cookie
compute_slope <- function(spectrum_values) {
pos <- 1:length(spectrum_values)
lm_model <- lm(spectrum_values ~ pos)
slope <- coef(lm_model)[2]
return(slope)
}
cookies_data$slope <- apply(cookies_data[, 2:701], 1, compute_slope)
# Create a data frame with features and target variable
cookies_features_data <- data.frame(
mean = cookies_data$mean,
stDev = cookies_data$stDev,
min = cookies_data$min,
max = cookies_data$max,
slope = cookies_data$slope,
YBin = YBin
)
head(cookies_features_data)
# Load the dataset
cookies_data <- read.csv(file = "cookies.csv", header = TRUE)
# Create the binary target variable YBin
YBin <- as.numeric(tab$fat > median(cookies_data$fat))
# Computation (mean, standard deviation, minimum and maximum)
cookies_data$mean <- rowMeans(cookies_data[, 2:701])
cookies_data$stDev <- apply(cookies_data[, 2:701], 1, sd)
cookies_data$min <- apply(cookies_data[, 2:701], 1, min)
cookies_data$max <- apply(cookies_data[, 2:701], 1, max)
# Computation (slope)
# Function: compute_slope
# @param: spectrum_values of a cookie (here, column 2 to 701)
# @return: slope of the spectrum curve for a cookie
compute_slope <- function(spectrum_values) {
pos <- 1:length(spectrum_values)
lm_model <- lm(spectrum_values ~ pos)
slope <- coef(lm_model)[2]
return(slope)
}
cookies_data$slope <- apply(cookies_data[, 2:701], 1, compute_slope)
# Create a data frame with features and target variable
cookies_features_data <- data.frame(
YBin = YBin,
mean = cookies_data$mean,
stDev = cookies_data$stDev,
min = cookies_data$min,
max = cookies_data$max,
slope = cookies_data$slope,
)
# Load the dataset
cookies_data <- read.csv(file = "cookies.csv", header = TRUE)
# Create the binary target variable YBin
YBin <- as.numeric(tab$fat > median(cookies_data$fat))
# Computation (mean, standard deviation, minimum and maximum)
cookies_data$mean <- rowMeans(cookies_data[, 2:701])
cookies_data$stDev <- apply(cookies_data[, 2:701], 1, sd)
cookies_data$min <- apply(cookies_data[, 2:701], 1, min)
cookies_data$max <- apply(cookies_data[, 2:701], 1, max)
# Computation (slope)
# Function: compute_slope
# @param: spectrum_values of a cookie (here, column 2 to 701)
# @return: slope of the spectrum curve for a cookie
compute_slope <- function(spectrum_values) {
pos <- 1:length(spectrum_values)
lm_model <- lm(spectrum_values ~ pos)
slope <- coef(lm_model)[2]
return(slope)
}
cookies_data$slope <- apply(cookies_data[, 2:701], 1, compute_slope)
# Create a data frame with features and target variable
cookies_features_data <- data.frame(
YBin = YBin,
mean = cookies_data$mean,
stDev = cookies_data$stDev,
min = cookies_data$min,
max = cookies_data$max,
slope = cookies_data$slope
)
head(cookies_features_data)
?glm
# Fit logistic regression model
model <- glm(YBin ~ ., data = cookies_features_data, family = "binomial")
# Display the summary of the model
summary(model)
knitr::opts_chunk$set(echo = TRUE)
# Load the dataset
cookies_data <- read.table(file = "cookies.csv", header = TRUE)
# Load the dataset
cookies_data <- read.csv(file = "cookies.csv", header = TRUE)
# Create the binary target variable YBin
YBin <- as.numeric(cookies_data$Y > median(cookies_data$Y))
# Spectra as predictors
spectra_predictors <- cookies_data[, 2:701]
# Fit logistic regression model
model <- glm(YBin ~ ., data = spectra_predictors, family = "binomial")
head(spectra_predictors)
# Load the dataset
cookies_data <- read.csv(file = "cookies.csv", header = TRUE)
# Create the binary target variable YBin
YBin <- as.numeric(cookies_data$Y > median(cookies_data$Y))
# Spectra as predictors
spectra_predictors <- cookies_data[, 2:701]
# Add the YBin column to the predictors
spectra_predictors$YBin <- YBin
